# TaskieX

배관 검사 이미지 및 비디오 처리를 위한 유틸리티 프로그램입니다.

## 주요 기능

1. **파일명 변경 모드**
   - 비디오 파일에서 프레임을 추출하고 Vision API와 ChatGPT로 분석하여 파일명 자동 변경
   - 이미지 파일의 이름을 직전에 처리된 비디오 파일명 기준으로 변경

2. **이미지 삽입 모드**
   - 이미지 파일명으로부터 정보(동, 호, 배관종류, 배관명 등)를 추출하여 Excel 파일에 삽입
   - 엑셀 시트별로 구분하여 이미지와 정보 관리
   - 이상위치 시트에 해당 셀 위치 노란색으로 자동 표시

## 바로 실행하기

### Windows 사용자

1. **간편 시작**
   - `바로실행.bat` 파일을 더블클릭하세요.
   - 자동으로 Python 설치 및 필요한 모든 패키지를 설치한 후 프로그램을 실행합니다.
   - 첫 실행 시 약간의 시간이 소요될 수 있습니다.

### Mac 사용자

1. **간편 시작**
   - `TaskieX 실행하기.command` 파일에 실행 권한을 부여하세요:
     ```
     chmod +x "TaskieX 실행하기.command"
     ```
   - `TaskieX 실행하기.command` 파일을 더블클릭하세요.
   - 자동으로 필요한 환경을 설정하고 프로그램을 실행합니다.

### Linux 사용자

1. **간편 시작**
   - `TaskieX 실행하기.sh` 파일에 실행 권한을 부여하세요:
     ```
     chmod +x "TaskieX 실행하기.sh"
     ```
   - 다음 명령어로 실행하세요:
     ```
     ./TaskieX\ 실행하기.sh
     ```
   - 자동으로 필요한 환경을 설정하고 프로그램을 실행합니다.

## API 키 설정

다음 폴더에 각각의 API 키 파일을 넣어야 합니다:
- `vision-api-key/`: Google Vision API 키 파일 (JSON)
- `chatgpt-api-key/`: OpenAI API 키 파일 (텍스트, `chatgpt_api_key.txt` 이름으로 저장)
- `gemini-api-key/`: Google Gemini API 키 파일 (텍스트, `gemini-api-key.txt` 이름으로 저장, 선택적)

## 파일 형식 및 구조

### 파일명 변경 모드
작업 폴더에 비디오 파일과 이미지 파일을 넣고 실행합니다.

### 이미지 삽입 모드
파일명은 다음 형식을 따라야 합니다:
```
[동] [호] [배관종류] [배관명]_[이상소견]_[이상위치]
```

예시: `101동 205호 세대매립관 앞발코니배수_물고임_입구.jpg`

## 사용 방법

1. TaskieX 실행
2. 작업 모드 선택 (파일명 변경 또는 이미지 삽입)
3. 작업 폴더 선택
4. 이미지 삽입 모드의 경우 엑셀 파일도 선택
5. '시작' 버튼을 클릭하여 처리 시작

자세한 사용 방법은 USER_MANUAL.md 파일을 참조하세요.

## 문제 해결

- **실행 파일 실행 시 오류**: 관리자 권한으로 실행해 보세요.
- **API 키 오류**: API 키 파일이 올바른 폴더에 있는지 확인하세요.
- **파일 인식 오류**: 파일 형식과 이름이 올바른지 확인하세요.
- **Mac/Linux에서 실행 권한 오류**: `chmod +x "TaskieX 실행하기.command"` 또는 `chmod +x "TaskieX 실행하기.sh"`로 실행 권한을 부여하세요.

## 라이선스

Copyright © 2024 